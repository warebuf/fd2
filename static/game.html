<html lang="en">
<head>
    <title>.</title>
    <style>
        * {
            border: 1px solid pink;
	    	margin: 0px;
	    	padding: 0px;
        }
	body {
		height:100%;
		margin: 0;
		overflow: hidden;
	}

	#container {
		position:relative;
	}

	#test {
		position: absolute;
		padding: 0px;
		text-align: center;
		max-width: 100%;
		width: 100%;
		margin-left:auto;
		margin-right:auto;
		top:50%;
		left:50%;
		transform:translate(-50%,-50%);
	}
	#format {
		position: absolute;
		padding: 0px;
		text-align: center;
		max-width: 100%;
		width: 100%;
		margin-left:auto;
		margin-right:auto;
		top:55%;
		left:50%;
		transform:translate(-50%,-50%);
	}
	#opponent {
		position: absolute;
		padding: 0px;
		text-align: center;
		max-width: 100%;
		width: 100%;
		margin-left:auto;
		margin-right:auto;
		top:57%;
		left:50%;
		transform:translate(-50%,-50%);
		background-color: red;
	}

		#matches {
			position: absolute;
			padding: 0px;
			text-align: center;
			max-width: 100%;
			width: 100%;
			margin-left:auto;
			margin-right:auto;
			top:10%;
			left:50%;
			transform:translate(-50%,-50%);
			background-color: yellow;
		}

		#panel,#panel_body,#panel_footer,#panel_join,#panel_spectate {
			 position: absolute;
			 padding: 0px;
			 text-align: center;
			 max-width: 100%;
			 width: 100%;
			 margin-left:auto;
			 margin-right:auto;
			 top:15%;
			 left:50%;
			 transform:translate(-50%,-50%);
			 background-color: green;
		 }



    </style>
</head>


<body>

<div id="matches"><div id="panel"></div></div>

<div id="container">
	<div id="test">
		<button id="b1", onclick="removeB1()">Connect to a Match</button>
	</div>
	<div id="format">
		<label>Choose a Format:</label>
		<select id="formatselect">
			<option value="ffa">Free For All</option>
			<option value="tea">Team</option>
			<option value="1vx">1vX</option>
		</select>
	</div>
	<div id="opponent">
		<label>Choose an Opponent:</label>
		<select id="opponentselect">
			<option value="bot">player vs. bot</option>
			<option value="pla">player vs. player</option>
		</select>
	</div>

	<canvas id="myCanvas"></canvas>
</div>



<script src="https://cdn.socket.io/socket.io-3.0.5.js"></script>
<script src="/static/engine.js"></script>

<script>
	var socket = null;

	function test() {

		if (!window["WebSocket"]) {
			alert("Error: Your browser does not support web sockets.")
		} else {
			socket = new WebSocket("ws://{{.host}}/matchmaking");
			socket.onclose = function() {
				alert("Connection has been closed.");
			}
			// Send a ping event every 100 seconds, have to either later remove this when we move away from heroku, or server-side internalize the ping event
			setInterval(() => socket.send(JSON.stringify({ "Event": 'ping' })), 100000);

			socket.onmessage = function(e) {
				var msg = eval('('+e.data+')');
				console.log(msg.Event, msg.Name)

				var div_parent = document.getElementById("matches");
				var div_child = document.createElement("div");
				div_child.setAttribute("id","panel")
				var div_body = document.createElement("div");
				div_body.setAttribute("id","panel_body")
				div_body.appendChild(document.createTextNode(msg.Event+msg.Name));
				var div_footer = document.createElement("div");
				div_footer.setAttribute("id","panel_footer")
				var div_but1 = document.createElement("button");
				div_but1.setAttribute("id","panel_join")
				div_but1.appendChild(document.createTextNode("Join"));
				var div_but2 = document.createElement("button");
				div_but2.setAttribute("id","spectate")
				div_but2.appendChild(document.createTextNode("Spectate"));

				div_footer.appendChild(div_but1)
				div_footer.appendChild(div_but2)
				div_child.appendChild(div_body)
				div_child.appendChild(div_footer)
				div_parent.appendChild(div_child)
			}
		}
	}
	test()

</script>
</body>
</html>
